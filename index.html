	<div id="recordatorios" style="margin-bottom:20px;"></div>
	<div id="reservasFuturas" style="margin-bottom:20px;"></div>
	<div id="historialReservas" style="margin-bottom:20px;"></div>
	<button id="btnInformeOcupadas" style="background:#27ae60; color:#fff; padding:10px 20px; border:none; border-radius:4px; margin-bottom:20px; cursor:pointer;">Informe de Habitaciones Ocupadas</button>
	<div id="informeOcupadas" style="margin-bottom:20px;"></div>
				<h2>Reservar Habitación</h2>
				<form id="formReserva">
				<button type="button" id="cancelarReservaBtn" style="background:#e67e22; color:#fff; margin-top:10px;">Cancelar Reserva Seleccionada</button>
					<label>Habitación
						<select id="habitacionReserva"></select>
					</label>
					<label>Nombre del Huésped
						<input type="text" id="nombreReserva" required>
					</label>
					<label>Fecha de Ingreso
						<input type="date" id="fechaReservaIngreso" required>
					</label>
					<label>Fecha de Salida
						<input type="date" id="fechaReservaSalida" required>
					</label>
					<button type="submit">Reservar</button>
				</form>
<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Sistema de Recepción de Hotel</title>
	<style>
		body { font-family: Arial, sans-serif; background: #f4f4f4; margin: 0; padding: 0; }
		.container { max-width: 900px; margin: 30px auto; background: #fff; padding: 30px; border-radius: 10px; box-shadow: 0 2px 8px #ccc; }
		h1 { text-align: center; color: #2c3e50; }
		.flex { display: flex; gap: 30px; }
		.form-section, .list-section { flex: 1; }
		label { display: block; margin-top: 10px; }
		input, select { width: 100%; padding: 7px; margin-top: 5px; border-radius: 4px; border: 1px solid #ccc; }
		button { margin-top: 15px; padding: 10px 20px; background: #2980b9; color: #fff; border: none; border-radius: 4px; cursor: pointer; }
		button:hover { background: #3498db; }
		table { width: 100%; border-collapse: collapse; margin-top: 20px; }
		th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
		th { background: #2980b9; color: #fff; }
		.disponible { color: green; font-weight: bold; }
		.ocupada { color: red; font-weight: bold; }
	</style>
</head>
<body>
	<div class="container">
		<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
			<h1 style="margin: 0;">Sistema de Recepción de Hotel</h1>
			<button id="borrarTodo" style="background:#e74c3c; color:#fff; padding:10px 20px; border:none; border-radius:4px; cursor:pointer;">Borrar Todo</button>
		</div>

		<div class="flex">
			<div class="form-section">
				<h2>Registrar Habitación</h2>
				<form id="formHabitacion">
					<label>Número de Habitación
						<input type="text" id="numeroHabitacion" required>
					</label>
					   <!-- Campo tipo eliminado -->
					<button type="submit">Agregar Habitación</button>
				</form>

				<h2>Check-in</h2>

				<form id="formCheckin">
					<label>Habitación
						<select id="habitacionCheckin"></select>
					</label>
					<label>Nombre del Huésped
						<input type="text" id="nombreHuesped" required>
					</label>
					<label>Fecha de Ingreso
						<input type="date" id="fechaIngreso" required>
					</label>
					<label>Fecha de Salida
						<input type="date" id="fechaSalida" required>
					</label>
					<button type="submit">Registrar Check-in</button>
				</form>

				<h2>Check-out</h2>
				<form id="formCheckout">
					<label>Habitación
						<select id="habitacionCheckout"></select>
					</label>
					<button type="submit">Registrar Check-out</button>
				</form>
			</div>
			<div class="list-section">
				<h2>Estado de Habitaciones</h2>
				<table>
					<thead>
						<tr>
							   <th>Número</th>
							   <th>Estado</th>
							<th>Huésped</th>
							<th>Ingreso</th>
							<th>Salida</th>
						</tr>
					</thead>
					<tbody id="tablaHabitaciones"></tbody>
				</table>
			</div>
		</div>
	</div>
	<script>
// Asegurar que el botón funcione correctamente al cargar el DOM
document.addEventListener('DOMContentLoaded', function() {
	var btn = document.getElementById('borrarTodo');
	if (btn) {
		btn.onclick = function() {
			if (confirm('¿Seguro que deseas borrar todos los datos?')) {
				localStorage.removeItem('habitaciones');
				render();
			}
		};
	}
});
		// Utilidades para LocalStorage
		function getHabitaciones() {
			return JSON.parse(localStorage.getItem('habitaciones') || '[]');
		}
		function setHabitaciones(habs) {
			localStorage.setItem('habitaciones', JSON.stringify(habs));
		}

		// Renderizar tabla y selects
		function render() {
			let habitaciones = getHabitaciones();
			// Si no hay habitaciones, crear 41 por defecto
			if (habitaciones.length === 0) {
				habitaciones = Array.from({length: 41}, (_, i) => ({
					numero: (i+1).toString(),
					estado: 'Disponible',
					reservas: [], // lista de reservas futuras y actuales
					ocupacion: null // {huesped, fechaIngreso, fechaSalida} si está ocupada
				}));
				setHabitaciones(habitaciones);
			}
				const tabla = document.getElementById('tablaHabitaciones');
				const selectCheckin = document.getElementById('habitacionCheckin');
				const selectCheckout = document.getElementById('habitacionCheckout');
				const selectReserva = document.getElementById('habitacionReserva');
				tabla.innerHTML = '';
				selectCheckin.innerHTML = '';
				selectCheckout.innerHTML = '';
				selectReserva.innerHTML = '';
				const hoy = new Date().toISOString().slice(0,10);
				let recordatorios = [];
				let reservasFuturas = [];
				let historial = [];
				habitaciones.forEach(h => {
					// Buscar reservas activas, futuras y pasadas
					let reservaHoy = null;
					let futuras = [];
					let pasadas = [];
					if (h.reservas && h.reservas.length > 0) {
						h.reservas.forEach(r => {
							if (r.fechaIngreso === hoy) reservaHoy = r;
							else if (r.fechaIngreso > hoy) futuras.push(r);
							else if (r.fechaSalida < hoy) pasadas.push(r);
						});
					}
					// Estado visual
					let estado = h.estado;
					if (h.ocupacion) {
						estado = 'Ocupada';
					} else if (reservaHoy) {
						estado = 'Reservada';
						recordatorios.push(`Habitación ${h.numero} - Check-in hoy para ${reservaHoy.huesped}`);
					} else if (futuras.length > 0) {
						estado = 'Reservada';
					} else {
						estado = 'Disponible';
					}
					// Tabla principal: mostrar todas las reservas futuras si no está ocupada
					if (h.ocupacion) {
						const tr = document.createElement('tr');
						tr.innerHTML = `
							<td>${h.numero}</td>
							<td class="ocupada">Ocupada</td>
							<td>${h.ocupacion.huesped}</td>
							<td>${h.ocupacion.fechaIngreso}</td>
							<td>${h.ocupacion.fechaSalida}</td>
						`;
						tabla.appendChild(tr);
					} else if (futuras.length > 0) {
						futuras.forEach((r, idx) => {
							const tr = document.createElement('tr');
							tr.innerHTML = `
								<td>${h.numero}</td>
								<td class="reservada" style="color:#e67e22;font-weight:bold;">Reservada${(r.fechaIngreso===hoy)?' <span style=\"color:#e67e22\">¡Check-in hoy!</span>':''}</td>
								<td>${r.huesped}</td>
								<td>${r.fechaIngreso}</td>
								<td>${r.fechaSalida}</td>
							`;
							tabla.appendChild(tr);
						});
					} else {
						const tr = document.createElement('tr');
						tr.innerHTML = `
							<td>${h.numero}</td>
							<td class="disponible">Disponible</td>
							<td></td>
							<td></td>
							<td></td>
						`;
						tabla.appendChild(tr);
					}
					// Selects
					if (!h.ocupacion && (!reservaHoy || reservaHoy.fechaIngreso <= hoy)) {
						const opt = document.createElement('option');
						opt.value = h.numero;
						opt.textContent = h.numero;
						selectCheckin.appendChild(opt);
					}
					if (h.ocupacion) {
						const opt = document.createElement('option');
						opt.value = h.numero;
						opt.textContent = h.numero;
						selectCheckout.appendChild(opt);
					}
					// El selector de reservas debe mostrar siempre todas las habitaciones
					const optReserva = document.createElement('option');
					optReserva.value = h.numero;
					optReserva.textContent = h.numero;
					selectReserva.appendChild(optReserva);
					// Reservas futuras para lista aparte
					futuras.forEach((r, idx) => reservasFuturas.push(`Habitación ${h.numero} - ${r.huesped} (${r.fechaIngreso} a ${r.fechaSalida}) <button onclick=\"cancelarReserva('${h.numero}',${idx})\" style=\"background:#e67e22;color:#fff;border:none;padding:2px 8px;border-radius:3px;cursor:pointer;\">Cancelar</button>`));
					// Historial de reservas pasadas
					pasadas.forEach(r => historial.push(`Habitación ${h.numero} - ${r.huesped} (${r.fechaIngreso} a ${r.fechaSalida})`));
				});
		// Informe de habitaciones ocupadas
		document.getElementById('btnInformeOcupadas').onclick = function() {
			let habitaciones = getHabitaciones();
			let ocupadas = habitaciones.filter(h => h.ocupacion);
			let html = '';
			if (ocupadas.length === 0) {
				html = '<b>No hay habitaciones ocupadas actualmente.</b>';
			} else {
				html = '<b>Habitaciones ocupadas:</b><ul>' + ocupadas.map(h => `<li>Habitación ${h.numero} - ${h.ocupacion.huesped} (${h.ocupacion.fechaIngreso} a ${h.ocupacion.fechaSalida})</li>`).join('') + '</ul>';
			}
			document.getElementById('informeOcupadas').innerHTML = html;
		};
				// Mostrar recordatorios
				const recDiv = document.getElementById('recordatorios');
				if (recordatorios.length > 0) {
					recDiv.innerHTML = `<b>Reservaciones para hoy:</b><ul><li>${recordatorios.join('</li><li>')}</li></ul>`;
				} else {
					recDiv.innerHTML = '';
				}
				// Mostrar reservas futuras
				const futDiv = document.getElementById('reservasFuturas');
				if (reservasFuturas.length > 0) {
					futDiv.innerHTML = `<b>Reservaciones futuras:</b><ul><li>${reservasFuturas.join('</li><li>')}</li></ul>`;
				} else {
					futDiv.innerHTML = '';
				}
				// Mostrar historial de reservas pasadas
				const histDiv = document.getElementById('historialReservas');
				if (historial.length > 0) {
					histDiv.innerHTML = `<b>Historial de reservas pasadas:</b><ul><li>${historial.join('</li><li>')}</li></ul>`;
				} else {
					histDiv.innerHTML = '';
				}
		// Cancelar reserva futura
		window.cancelarReserva = function(numero, idx) {
			let habitaciones = getHabitaciones();
			habitaciones = habitaciones.map(h => {
				if (h.numero === numero) {
					let nuevas = h.reservas.filter((_, i) => i !== idx);
					return { ...h, reservas: nuevas };
				}
				return h;
			});
			setHabitaciones(habitaciones);
			render();
		}
		// Reservar habitación (agrega a la lista de reservas de la habitación)
		document.getElementById('formReserva').onsubmit = function(e) {
			e.preventDefault();
			const numero = document.getElementById('habitacionReserva').value;
			const huesped = document.getElementById('nombreReserva').value.trim();
			const fechaIngreso = document.getElementById('fechaReservaIngreso').value;
			const fechaSalida = document.getElementById('fechaReservaSalida').value;
			if (!numero || !huesped || !fechaIngreso || !fechaSalida) return;
			if (fechaSalida < fechaIngreso) {
				alert('La fecha de salida no puede ser antes de la fecha de ingreso.');
				return;
			}
			let habitaciones = getHabitaciones();
			habitaciones = habitaciones.map(h => {
				if (h.numero === numero) {
					// Validar que no se cruce con otra reserva ni con ocupación actual
					let conflicto = false;
					if (h.ocupacion) {
						// Si la ocupación actual se traslapa
						if (!(fechaSalida < h.ocupacion.fechaIngreso || fechaIngreso > h.ocupacion.fechaSalida)) {
							conflicto = true;
						}
					}
					if (!conflicto && h.reservas.some(r => !(fechaSalida < r.fechaIngreso || fechaIngreso > r.fechaSalida))) {
						conflicto = true;
					}
					if (conflicto) {
						alert('Ya existe una reserva u ocupación que se cruza con esas fechas.');
						return h;
					}
					// Ordenar reservas por fechaIngreso
					const nuevasReservas = [...h.reservas, { huesped, fechaIngreso, fechaSalida }].sort((a,b)=>a.fechaIngreso.localeCompare(b.fechaIngreso));
					return { ...h, reservas: nuevasReservas };
				}
				return h;
			});
			setHabitaciones(habitaciones);
			this.reset();
			render();
		};
		}

		// Agregar habitación
		document.getElementById('formHabitacion').onsubmit = function(e) {
			e.preventDefault();
			const numero = document.getElementById('numeroHabitacion').value.trim();
			if (!numero) return;
			let habitaciones = getHabitaciones();
			if (habitaciones.some(h => h.numero === numero)) {
				alert('Ya existe una habitación con ese número.');
				return;
			}
			habitaciones.push({ numero, estado: 'Disponible', reservas: [], ocupacion: null });
			setHabitaciones(habitaciones);
			this.reset();
			render();
		};

		// Check-in: solo si hay reserva activa para hoy o si está libre
		document.getElementById('formCheckin').onsubmit = function(e) {
			e.preventDefault();
			const numero = document.getElementById('habitacionCheckin').value;
			const huesped = document.getElementById('nombreHuesped').value.trim();
			const fechaIngreso = document.getElementById('fechaIngreso').value;
			const fechaSalida = document.getElementById('fechaSalida').value;
			if (!numero || !huesped || !fechaIngreso || !fechaSalida) return;
			if (fechaSalida < fechaIngreso) {
				alert('La fecha de salida no puede ser antes de la fecha de ingreso.');
				return;
			}
			let habitaciones = getHabitaciones();
			habitaciones = habitaciones.map(h => {
				if (h.numero === numero) {
					// No permitir check-in si está ocupada o si hay una reserva de otro huésped para ese rango
					if (h.ocupacion) {
						alert('La habitación ya está ocupada.');
						return h;
					}
					if (h.reservas.some(r => !(fechaSalida < r.fechaIngreso || fechaIngreso > r.fechaSalida) && r.huesped !== huesped)) {
						alert('Ya existe una reserva de otro huésped que se cruza con esas fechas.');
						return h;
					}
					// Si hay una reserva para este huésped y rango, la quitamos
					let nuevaReservas = h.reservas.filter(r => (r.huesped !== huesped || r.fechaIngreso !== fechaIngreso || r.fechaSalida !== fechaSalida));
					return { ...h, ocupacion: { huesped, fechaIngreso, fechaSalida }, reservas: nuevaReservas, estado: 'Ocupada' };
				}
				return h;
			});
			setHabitaciones(habitaciones);
			this.reset();
			render();
		};

		// Check-out: libera la ocupación actual
		document.getElementById('formCheckout').onsubmit = function(e) {
			e.preventDefault();
			const numero = document.getElementById('habitacionCheckout').value;
			if (!numero) return;
			let habitaciones = getHabitaciones();
			habitaciones = habitaciones.map(h =>
				h.numero === numero ? { ...h, ocupacion: null, estado: 'Disponible' } : h
			);
			setHabitaciones(habitaciones);
			this.reset();
			render();
		};

		// Inicializar
		render();
	</script>
</body>
</html>
